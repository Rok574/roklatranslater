<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>iOS Home</title>

<style>
body{
  margin:0;
  font-family:-apple-system,system-ui;
  background:#000;
  color:white;
  overflow:hidden;
}

#wallpaper{
  position:fixed;
  inset:0;
  background:#000 center/cover no-repeat;
  z-index:0;
}

#home{
  position:absolute;
  inset:0;
  padding:20px;
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:22px;
  align-content:start;
  z-index:1;
}

.app{
  text-align:center;
  cursor:pointer;
}

.app img{
  width:64px;
  height:64px;
  border-radius:14px;
}

.app span{
  display:block;
  font-size:12px;
  margin-top:6px;
}

.window{
  position:fixed;
  inset:0;
  background:#000;
  display:none;
  flex-direction:column;
  z-index:10;
}

.header{
  padding:16px;
  border-bottom:1px solid #222;
  font-weight:600;
  display:flex;
  justify-content:space-between;
}

input,textarea{
  background:#111;
  color:white;
  border:1px solid #222;
  border-radius:10px;
  padding:12px;
  width:100%;
  margin-bottom:10px;
}

button{
  background:#007aff;
  border:none;
  color:white;
  padding:12px;
  border-radius:10px;
}
</style>
</head>
<body>

<div id="wallpaper"></div>
<div id="home"></div>

<!-- SETTINGS -->
<div id="settings" class="window">
  <div class="header">
    <div>Settings</div>
    <div onclick="goHome()" style="color:#007aff;cursor:pointer">Done</div>
  </div>
  <div style="padding:16px">
    <h3>Add Web App</h3>
    <input id="webName" placeholder="App Name">
    <input id="webUrl" placeholder="example.com">
    <input id="webIcon" type="file" accept="image/*">
    <button onclick="addWebApp()">Add to Home Screen</button>
  </div>
</div>

<!-- NOTES -->
<div id="notes" class="window">
  <div class="header">
    <div>Notes</div>
    <div onclick="newNote()" style="color:#007aff;cursor:pointer">New</div>
  </div>
  <div id="notesList" style="padding:16px;overflow:auto;flex:1"></div>
</div>

<div id="editor" class="window">
  <div class="header">
    <div onclick="closeEditor()" style="color:#007aff;cursor:pointer">Back</div>
    <div onclick="deleteNote()" style="color:#ff3b30;cursor:pointer">Delete</div>
  </div>
  <div style="padding:16px;flex:1">
    <input id="noteTitle" placeholder="Title">
    <textarea id="noteContent" style="height:60vh"></textarea>
  </div>
</div>

<!-- BROWSER -->
<div id="browser" class="window">
  <div class="header">
    <div>Browser</div>
    <div onclick="goHome()" style="color:#007aff;cursor:pointer">Done</div>
  </div>
  <div style="padding:16px">
    <input id="browserUrl" placeholder="example.com">
    <button onclick="openUrl()">Go</button>
    <h3>Favorites</h3>
    <input id="favInput" placeholder="example.com">
    <button onclick="addFavorite()">Add Favorite</button>
    <div id="favList"></div>
  </div>
</div>

<script>
let apps = JSON.parse(localStorage.getItem("apps")) || [
  {name:"Notes",type:"notes",icon:"https://i.imgur.com/9D6V4Xx.png"},
  {name:"Browser",type:"browser",icon:"https://i.imgur.com/XV3Txqf.png"},
  {name:"Settings",type:"settings",icon:"https://i.imgur.com/crghH6U.png"}
];

function saveApps(){
  localStorage.setItem("apps",JSON.stringify(apps));
}

function render(){
  const home=document.getElementById("home");
  home.innerHTML="";
  apps.forEach(app=>{
    const div=document.createElement("div");
    div.className="app";
    div.innerHTML=`<img src="${app.icon}"><span>${app.name}</span>`;
    div.onclick=()=>openApp(app);
    home.appendChild(div);
  });
}

function openApp(app){
  if(app.url){
    window.open(app.url,"_blank");
    return;
  }
  document.getElementById(app.type).style.display="flex";
}

function goHome(){
  document.querySelectorAll(".window").forEach(w=>w.style.display="none");
}

/* WEB APP FIX */
function addWebApp(){
  let name=document.getElementById("webName").value.trim();
  let url=document.getElementById("webUrl").value.trim();
  let file=document.getElementById("webIcon").files[0];

  if(!name||!url||!file){
    alert("Fill all fields");
    return;
  }

  if(!url.startsWith("http://")&&!url.startsWith("https://")){
    url="https://"+url;
  }

  const reader=new FileReader();
  reader.onload=e=>{
    apps.push({
      name:name,
      url:url,
      icon:e.target.result
    });

    saveApps();
    render();

    document.getElementById("webName").value="";
    document.getElementById("webUrl").value="";
    document.getElementById("webIcon").value="";

    alert("Added to Home Screen");
    goHome();
  };
  reader.readAsDataURL(file);
}

/* NOTES FIX */
let notes=JSON.parse(localStorage.getItem("notes"))||[];
let current=null;

function saveNotes(){
  localStorage.setItem("notes",JSON.stringify(notes));
}

function renderNotes(){
  const list=document.getElementById("notesList");
  list.innerHTML="";
  notes.forEach(n=>{
    const div=document.createElement("div");
    div.style.padding="10px 0";
    div.style.borderBottom="1px solid #222";
    div.textContent=n.title||"New Note";
    div.onclick=()=>openNote(n.id);
    list.appendChild(div);
  });
}

function newNote(){
  const note={id:Date.now(),title:"",content:""};
  notes.unshift(note);
  saveNotes();
  openNote(note.id);
}

function openNote(id){
  current=id;
  const note=notes.find(n=>n.id===id);
  document.getElementById("noteTitle").value=note.title;
  document.getElementById("noteContent").value=note.content;
  document.getElementById("notes").style.display="none";
  document.getElementById("editor").style.display="flex";
}

function closeEditor(){
  const note=notes.find(n=>n.id===current);
  note.title=document.getElementById("noteTitle").value;
  note.content=document.getElementById("noteContent").value;
  saveNotes();
  renderNotes();
  goHome();
}

function deleteNote(){
  notes=notes.filter(n=>n.id!==current);
  saveNotes();
  renderNotes();
  goHome();
}

/* FAVORITES FIX */
let favorites=JSON.parse(localStorage.getItem("favorites"))||[];

function saveFav(){
  localStorage.setItem("favorites",JSON.stringify(favorites));
}

function renderFav(){
  const list=document.getElementById("favList");
  list.innerHTML="";
  favorites.forEach(url=>{
    const div=document.createElement("div");
    div.style.padding="6px 0";
    div.textContent=url;
    div.onclick=()=>window.open(url,"_blank");
    list.appendChild(div);
  });
}

function addFavorite(){
  let url=document.getElementById("favInput").value.trim();
  if(!url)return;
  if(!url.startsWith("http://")&&!url.startsWith("https://")){
    url="https://"+url;
  }
  favorites.push(url);
  saveFav();
  renderFav();
  document.getElementById("favInput").value="";
}

function openUrl(){
  let url=document.getElementById("browserUrl").value.trim();
  if(!url)return;
  if(!url.startsWith("http://")&&!url.startsWith("https://")){
    url="https://"+url;
  }
  window.open(url,"_blank");
}

render();
renderNotes();
renderFav();
</script>
</body>
</html>
